<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mogaland-Plume Simulator</title>
  <script src="https://cdn.ethers.io/lib/ethers-5.7.umd.min.js"></script>
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial@0.2.0/dist/chartjs-chart-financial.min.js"></script>

  <style>
    :root {
      --primary: #0d6efd;
      --dark: #0a2540;
      --darker: #071a2e;
      --light: #f8f9fa;
      --bell: #ffcc00;
      --success: #28a745;
      --danger: #dc3545;
      --card-bg: #1e293b;
      --border: #334155;
      --progress: #3b82f6;
      --progress-end: #60a5fa;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--darker);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .login-container {
      background: rgba(0,0,0,0.5);
      border-radius: 20px;
      padding: 80px 40px;
      width: 100%;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.1);
      margin: 120px auto;
    }
    h1 { font-size: 3.2rem; margin-bottom: 12px; }
    .subtitle { font-size: 1.3rem; opacity: 0.8; margin-bottom: 50px; }
    .login-option {
      background: var(--primary);
      color: white;
      border: none;
      padding: 18px;
      font-size: 1.3rem;
      border-radius: 12px;
      cursor: pointer;
      margin: 20px 0;
      width: 100%;
      transition: all 0.3s;
    }
    .login-option:hover { background: #0b5ed7; transform: scale(1.02); }
    .input-field {
      width: 100%;
      padding: 14px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.05);
      color: white;
      font-size: 1.1rem;
    }
    .main-app {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
    }
    header {
      padding: 20px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 12px;
    }
    .top-btn {
      background: rgba(13,110,253,0.3);
      color: white;
      border: 1px solid var(--primary);
      padding: 10px 18px;
      font-size: 1rem;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .top-btn:hover { background: var(--primary); transform: scale(1.05); }
    .top-btn.connected { background: var(--success); border-color: var(--success); }
    .nav-bar {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(10px);
      border-radius: 60px;
      padding: 12px 20px;
      display: flex;
      gap: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 100;
    }
    .nav-btn {
      background: rgba(13,110,253,0.2);
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 1rem;
      border-radius: 40px;
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
    }
    .nav-btn:hover, .nav-btn.active { background: var(--primary); transform: scale(1.08); }
    .content { flex: 1; padding: 40px 20px; margin-top: 60px; text-align: center; }
    .hidden { display: none !important; }
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,204,0,0.2);
      border: 1px solid var(--bell);
      color: white;
      padding: 14px 24px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 1000;
      animation: bell 1.5s;
      max-width: 90%;
    }
    @keyframes bell { 0%,100% { transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.05); } }

    .flex-container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: stretch;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }
    @media (min-width: 992px) { .flex-container { flex-wrap: nowrap; } }
    @media (max-width: 992px) { .flex-container { flex-direction: column; } }

    .progress-box, .question-card, .card {
      min-height: 520px !important;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-sizing:border-box;
    }
    .question-card {
      min-height: 520px !important;
      flex: 1 1 420px;
      max-width: 500px;
    }
    .progress-box, .card {
      min-height: 520px !important;
      flex: 1 1 320px;
      max-width: 420px;
    }
    .question-box {
      flex: 1 1 420px;
      min-width: 380px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid var(--border);
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
    }
    .card h3 { color: #60a5fa; margin-bottom: 16px; text-align: center; font-size: 1.4em; }
    .progress-bar {
      background: var(--border);
      border-radius: 999px;
      height: 14px;
      overflow: hidden;
      margin: 12px 0;
    }
    .progress-fill {
      background: linear-gradient(90deg, var(--progress), var(--progress-end));
      height: 100%;
      transition: width 0.6s ease;
    }
    .btn-primary {
      width: 100%;
      padding: 14px;
      background: linear-gradient(90deg, var(--primary), var(--progress-end));
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1.1em;
      cursor: pointer;
      margin: 8px 0;
      transition: all 0.3s;
    }
    .btn-primary:hover { transform: scale(1.03); }
    .btn-success { background: linear-gradient(90deg, var(--success), #34d399); }
    .btn-group { display: flex; gap: 16px; margin-top: 24px; }

    .question-card {
      background: #0f172a;
      border-radius: 12px;
      padding: 28px;
      border: 1px solid var(--border);
      position: relative;
    }
    .question-number {
      position: absolute;
      top: -70px;
      left: -50px;
      font-size: 9rem;
      font-weight: bold;
      color: #60a5fa;
      opacity: 0.1;
      pointer-events: none;
      line-height: 1;
    }
    .question-title { font-size: 1.6em; margin-bottom: 24px; line-height: 1.4; }

    .progress-box {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
    }
    .progress-box h4 { color: #60a5fa; margin-bottom: 16px; font-size: 1.4em; }
    .progress-box .reach { font-size: 2em; font-weight: bold; color: #10b981; margin: 20px 0; }

    #progressTitle {
      font-size: 1.4em;
      color: #60a5fa;
      margin-bottom: 16px;
    }
    .nft-container {
      margin: 20px 0;
      flex-grow: 1;
      display: flex;
      align-items: center;
    }
    .nft-placeholder {
      width: 100%;
      height: 280px;
      border-radius: 16px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
    }
    .nft-gradient {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea, #764ba2, #ff9a9e, #fad0c4, #a18cd1);
      background-size: 400% 400%;
      animation: gradientFlow 20s ease infinite;
    }
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .nft-label {
      position: absolute;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.95em;
      backdrop-filter: blur(4px);
    }
    .progress-section {
      margin-top: 15px;
    }
    .progress-bar-long {
      height: 20px;
      background: var(--border);
      border-radius: 10px;
      overflow: hidden;
    }
    .progress-fill-long {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      transition: width 0.6s ease;
    }
    .progress-label {
      display: block;
      margin-top: 8px;
      font-weight: bold;
      color: #60a5fa;
      font-size: 1.1em;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      max-width: 960px;
      margin: 0 auto 40px auto;
    }
    .stats-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      min-height: 160px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .stats-card h4 {
      color: #94a3b8;
      font-size: 1.1em;
      margin-bottom: 12px;
    }
    .stats-value {
      font-size: 2.6em;
      font-weight: bold;
    }

    .nft-card {
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      transition: all 0.25s;
      position: relative;
    }
    .nft-card:hover { transform: translateY(-6px); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.5); }
    .nft-image-placeholder {
      height: 220px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8em;
      font-weight: bold;
      color: white;
      opacity: 0.9;
    }
    .nft-staked-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #10b981;
      color: white;
      font-size: 0.8em;
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: bold;
    }

    /* Profile Panel Styles */
    .profile-slide-panel {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 380px;
      background: #0f121a;
      border-left: 1px solid #1e2535;
      z-index: 99;
      transform: translateX(100%);
      transition: transform 0.35s ease;
      box-shadow: -10px 0 35px rgba(0,0,0,0.7);
      overflow-y: auto;
    }
    .profile-slide-panel:not(.hidden) { transform: translateX(0); }

    .profile-slide-header {
      padding: 18px 24px;
      background: #0a0d14;
      border-bottom: 1px solid #1e2535;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .gear-icon, .close-slide {
      background: none;
      border: none;
      color: #94a3b8;
      font-size: 1.6rem;
      cursor: pointer;
    }

    .profile-slide-balance {
      padding: 32px 24px 20px;
      text-align: center;
    }

    .profile-slide-total {
      font-size: 3.4rem;
      font-weight: 800;
      color: #34d399;
    }

    .profile-slide-actions {
      display: flex;
      gap: 12px;
      padding: 20px 24px;
    }

    .profile-slide-action-btn {
      flex: 1;
      padding: 14px;
      border-radius: 12px;
      border: none;
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .profile-slide-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }

    .profile-slide-action-btn.deposit { background: linear-gradient(90deg, #10b981, #34d399); }
    .profile-slide-action-btn.swap    { background: linear-gradient(90deg, #0d6efd, #60a5fa); }
    .profile-slide-action-btn.send    { background: linear-gradient(90deg, #8b5cf6, #c084fc); }

    .profile-slide-tabs {
      display: flex;
      margin: 0 24px;
      border-bottom: 1px solid #1e2535;
    }

    .profile-slide-tab {
      flex: 1;
      padding: 14px 0;
      background: none;
      border: none;
      color: #94a3b8;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    .profile-slide-tab:hover { color: #d1d5db; }
    .profile-slide-tab.active {
      color: white;
      border-bottom: 3px solid #60a5fa;
    }

    .profile-slide-tab:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(96,165,250,0.4);
    }

    /* Smooth tab content transition */
    .tab-content {
      padding: 20px;
      transition: opacity 0.28s ease, transform 0.28s ease;
      opacity: 0;
      transform: translateY(10px);
      pointer-events: none;
    }

    .tab-content.active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .profile-slide-assets, .profile-slide-activity {
      min-height: 300px;
    }

    .profile-slide-asset-row {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 0;
      border-bottom: 1px solid #1e2535;
    }
    .profile-slide-asset-row:last-child { border-bottom: none; }
    .profile-slide-asset-icon {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      object-fit: contain;
      background: #111;
      border: 1px solid #334155;
      flex-shrink: 0;
    }
    .profile-slide-asset-details { flex: 1; }
    .profile-slide-asset-name { font-weight: 600; font-size: 1.1em; }
    .profile-slide-asset-subtitle { font-size: 0.9em; color: #94a3b8; }
    .profile-slide-asset-amounts { text-align: right; }
    .profile-slide-token-amount { font-weight: bold; font-size: 1.1em; }
    .profile-slide-usd-amount { font-size: 0.95em; color: #94a3b8; }

    /* Back Profile Panel */
    .back-profile-panel {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 380px;
      background: #0f121a;
      border-left: 1px solid #1e2535;
      z-index: 99;
      transform: translateX(100%);
      transition: transform 0.35s ease;
      box-shadow: -10px 0 35px rgba(0,0,0,0.7);
      overflow-y: auto;
    }
    .back-profile-panel:not(.hidden) { transform: translateX(0); }

    .panel-content { padding: 24px; }
    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    .section {
      margin-bottom: 24px;
      background: #11151f;
      border-radius: 12px;
      padding: 16px;
      border: 1px solid #1e2535;
    }
    .section-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 14px;
      color: #cbd5e1;
    }
    .item {
      padding: 16px 0;
      border-bottom: 1px solid #1e2535;
    }
    .item:last-child { border-bottom: none; }
    .item-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }
    .item-text {
      flex: 1;
      font-size: 1.05rem;
      line-height: 1.45;
      word-break: break-word;
    }
    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      justify-content: flex-end;
    }
    .action-btn {
      padding: 7px 16px;
      font-size: 0.9rem;
      border-radius: 6px;
      cursor: pointer;
      border: none;
      color: white;
      min-width: 82px;
    }
    .connect-btn { background: #28a745; }
    .disconnect-btn { background: #ef4444; }
    .logout-btn {
      width: 100%;
      padding: 14px;
      background: #dc2626;
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1.05rem;
      cursor: pointer;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <!-- Login Page -->
  <div class="login-container" id="loginPage">
    <h1>Mogaland-Plume Simulator</h1>
    <p class="subtitle">Connect wallet or use mock login (demo only)</p>

    <button class="login-option" onclick="showWalletOptions()">Connect Wallet</button>
    <button class="login-option" onclick="showEmailLogin()">Login with Email</button>
    <button class="login-option" onclick="showXLogin()">Login with X (@username)</button>

    <div id="walletOptions" class="hidden">
      <h3 style="margin:20px 0;">Select Wallet</h3>
      <button class="wallet-choice" onclick="connectMetaMask()">MetaMask</button>
      <button class="wallet-choice" onclick="connectOKX()">OKX Wallet</button>
      <button class="wallet-choice" onclick="connectTrustWallet()">Trust Wallet</button>
      <button class="wallet-choice" onclick="connectWalletConnect()">WalletConnect</button>
    </div>

    <div id="emailLogin" class="hidden">
      <input type="email" id="emailInput" class="input-field" placeholder="Gmail or Yahoo email" />
      <button class="login-option" onclick="sendEmailCode()">Send Mock OTP</button>
      <input type="text" id="otpInput" class="input-field hidden" placeholder="OTP (123456)" />
      <button class="login-option hidden" id="verifyOtpBtn" onclick="verifyEmailOtp()">Verify</button>
    </div>

    <div id="xLogin" class="hidden">
      <input type="text" id="xInput" class="input-field" placeholder="@yourusername" />
      <button class="login-option" onclick="confirmXLogin()">Confirm</button>
    </div>

    <div id="notification-area"></div>
  </div>

  <!-- Main Dashboard -->
  <div class="main-app hidden" id="mainApp">
    <header>
      <button class="top-btn" id="walletBtn">Connected Wallet</button>
      <button class="top-btn" onclick="showProfile()">Profile</button>
    </header>

    <h1>Mogaland-Plume</h1>
    <div class="subtitle">Welcome!</div>

    <div class="content" id="content">
      <p>Select an option below to explore the simulator.</p>
    </div>

    <div class="nav-bar">
      <button class="nav-btn" onclick="showSection('learning', event)">Learning</button>
      <button class="nav-btn" onclick="showSection('market', event)">Market Prediction</button>
      <button class="nav-btn active" onclick="showSection('swap', event)">Swap</button>
      <button class="nav-btn" onclick="showSection('bridge', event)">Bridge</button>
      <button class="nav-btn" onclick="showSection('nft', event)">NFT Staking</button>
    </div>

    <!-- Profile Slide-in Panel -->
    <div id="profileSlidePanel" class="profile-slide-panel hidden">
      <div class="profile-slide-header">
        <button class="gear-icon" onclick="openBackProfile()">‚öôÔ∏è</button>
        <div class="account-title">Main Account ‚ñº</div>
        <button class="close-slide" onclick="closeProfileSlide()">√ó</button>
      </div>

      <div class="profile-slide-balance">
        <div class="profile-slide-total">$3.87</div>
        <div class="profile-slide-addresses">Addresses ></div>
      </div>

      <div class="profile-slide-actions">
        <button class="profile-slide-action-btn deposit" onclick="openDepositModal()">+ Deposit</button>
        <button class="profile-slide-action-btn swap" onclick="openSwapModal()">‚Üª Swap</button>
        <button class="profile-slide-action-btn send" onclick="openSendModal()">‚Üë Send</button>
      </div>

      <div class="profile-slide-tabs">
        <button class="profile-slide-tab active" data-tab="assets">Assets</button>
        <button class="profile-slide-tab" data-tab="activity">Activity</button>
      </div>

      <div class="tab-wrapper" style="position:relative; min-height:300px;">
        <div id="assetsContent" class="tab-content active">
          <div class="profile-slide-asset-row">
            <img src="https://plume.org/media-kit/plume-logomark-red.png" alt="PLUME" class="profile-slide-asset-icon">
            <div class="profile-slide-asset-details">
              <div class="profile-slide-asset-name">PLUME</div>
              <div class="profile-slide-asset-subtitle">Plume Native</div>
            </div>
            <div class="profile-slide-asset-amounts">
              <div class="profile-slide-token-amount">0.452</div>
              <div class="profile-slide-usd-amount">$0.92</div>
            </div>
          </div>

          <div class="profile-slide-asset-row">
            <img src="https://via.placeholder.com/44/FFCC00/000000?text=MOGA" alt="MOGA" class="profile-slide-asset-icon">
            <div class="profile-slide-asset-details">
              <div class="profile-slide-asset-name">MOGA</div>
              <div class="profile-slide-asset-subtitle">Mogaland Token</div>
            </div>
            <div class="profile-slide-asset-amounts">
              <div class="profile-slide-token-amount">1,245.67</div>
              <div class="profile-slide-usd-amount">$1.87</div>
            </div>
          </div>

          <div class="profile-slide-asset-row">
            <img src="https://cryptologos.cc/logos/usd-coin-usdc-logo.png?v=035" alt="USDC" class="profile-slide-asset-icon">
            <div class="profile-slide-asset-details">
              <div class="profile-slide-asset-name">USDC</div>
              <div class="profile-slide-asset-subtitle">USD Coin</div>
            </div>
            <div class="profile-slide-asset-amounts">
              <div class="profile-slide-token-amount">0.004</div>
              <div class="profile-slide-usd-amount">$0.004</div>
            </div>
          </div>

          <div class="profile-slide-asset-row">
            <img src="https://cryptologos.cc/logos/tether-usdt-logo.png?v=035" alt="USDT" class="profile-slide-asset-icon">
            <div class="profile-slide-asset-details">
              <div class="profile-slide-asset-name">USDT</div>
              <div class="profile-slide-asset-subtitle">Tether</div>
            </div>
            <div class="profile-slide-asset-amounts">
              <div class="profile-slide-token-amount">0.500</div>
              <div class="profile-slide-usd-amount">$0.500</div>
            </div>
          </div>
        </div>

        <div id="activityContent" class="tab-content">
          <div style="height: 300px; display: flex; align-items: center; justify-content: center; text-align: center; color: #94a3b8; font-size: 1.1em; padding: 20px;">
            <div>
              <div style="font-size: 2.8em; margin-bottom: 12px;">üì≠</div>
              No recent on-chain activity yet.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Back Profile Panel -->
    <div id="backProfilePanel" class="back-profile-panel hidden">
      <div class="panel-content">
        <div class="panel-header">
          <button class="gear-icon">‚öôÔ∏è</button>
          <div class="account-title">Main Account ‚ñº</div>
          <button class="close-panel" onclick="closeBackProfile()">√ó</button>
        </div>

        <div class="section login">
          <div class="section-title">Login</div>

          <div class="item">
            <div class="item-header">
              <span class="icon">üîó</span>
              <div class="item-text">Linked Wallets ...7D66</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item">
            <div class="item-header">
              <span class="icon">‚úâÔ∏è</span>
              <div class="item-text">Email aangcrypto21@gmail.com</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item">
            <div class="item-header">
              <span class="icon">G</span>
              <div class="item-text">Google aangcrypto2@gmail.com</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item">
            <div class="item-header">
              <span class="icon">X</span>
              <div class="item-text">Twitter @aangcrypto21</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item">
            <div class="item-header">
              <span class="icon">‚úàÔ∏è</span>
              <div class="item-text">Telegram Aang2121</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item">
            <div class="item-header">
              <span class="icon">Discord</span>
              <div class="item-text">aang123.#0</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>

          <div class="item passport">
            <div class="item-header">
              <span class="icon passport">üõ°Ô∏è</span>
              <div class="item-text">Plume Passport Connected</div>
            </div>
            <div class="button-group">
              <button class="action-btn connect-btn">Connect</button>
              <button class="action-btn disconnect-btn">Disconnect</button>
            </div>
          </div>
        </div>

        <button class="logout-btn" onclick="logoutUser()">Log Out</button>
      </div>
    </div>
  </div>

  <script>
    // === FULL SCRIPT - ALL FEATURES INCLUDED ===

    const PLUME_CHAIN_ID = 98866;
    const PLUME_RPC = "https://rpc.plume.org";

    let provider = null;
    let userAddress = null;
    const mockOtp = "123456";

    const walletConnectProvider = new WalletConnectProvider.default({
      rpc: { [PLUME_CHAIN_ID]: PLUME_RPC },
      chainId: PLUME_CHAIN_ID,
      qrcode: true
    });

    function showWalletOptions() { toggleSections('walletOptions'); }
    function showEmailLogin() { toggleSections('emailLogin'); }
    function showXLogin() { toggleSections('xLogin'); }

    function toggleSections(showId) {
      ['walletOptions','emailLogin','xLogin'].forEach(id => document.getElementById(id).classList.toggle('hidden', id !== showId));
    }

    function sendEmailCode() {
      const email = document.getElementById('emailInput').value.trim();
      if (!email.includes('@gmail.com') && !email.includes('@yahoo.com')) return showNotification("Use Gmail or Yahoo email.", true);
      showNotification(`Mock OTP sent: ${mockOtp}`);
      document.getElementById('otpInput').classList.remove('hidden');
      document.getElementById('verifyOtpBtn').classList.remove('hidden');
    }

    function verifyEmailOtp() {
      if (document.getElementById('otpInput').value.trim() === mockOtp) enterDashboard("Email");
      else showNotification("Wrong OTP", true);
    }

    function confirmXLogin() {
      const handle = document.getElementById('xInput').value.trim();
      if (!handle.startsWith('@')) return showNotification("Invalid @username", true);
      enterDashboard("X");
    }

    function enterDashboard(method) {
      showNotification(`Entered via ${method} (simulator mode)`, false);
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('mainApp').classList.remove('hidden');
    }

    async function connectWallet(walletType, getProvider) {
      try {
        provider = getProvider();
        await provider.send("eth_requestAccounts", []);
        const network = await provider.getNetwork();
        userAddress = (await provider.getSigner().getAddress()).toLowerCase();
        const status = network.chainId === PLUME_CHAIN_ID ? "Plume Mainnet" : `Wrong network (ID: ${network.chainId})`;
        document.getElementById('walletBtn').textContent = `Connected: ${userAddress.slice(0,6)}...${userAddress.slice(-4)}`;
        document.getElementById('walletBtn').classList.add('connected');
        showNotification(`Connected via ${walletType} ‚Äì ${status}`, network.chainId !== PLUME_CHAIN_ID);
        enterDashboard(walletType);
      } catch (e) {
        showNotification("Connection failed: " + (e.message || "Error"), true);
      }
    }

    function connectMetaMask() {
      if (!window.ethereum) return showNotification("MetaMask not found", true);
      connectWallet("MetaMask", () => new ethers.providers.Web3Provider(window.ethereum));
    }

    function connectOKX() {
      if (!window.okxwallet) return showNotification("OKX not found", true);
      connectWallet("OKX", () => new ethers.providers.Web3Provider(window.okxwallet));
    }

    function connectTrustWallet() {
      if (!window.ethereum || !window.ethereum.isTrust) return showNotification("Trust not detected", true);
      connectWallet("Trust", () => new ethers.providers.Web3Provider(window.ethereum));
    }

    async function connectWalletConnect() {
      try {
        await walletConnectProvider.enable();
        connectWallet("WalletConnect", () => new ethers.providers.Web3Provider(walletConnectProvider));
      } catch (e) {
        showNotification("WalletConnect error", true);
      }
    }

    function showNotification(msg, error = false) {
      const div = document.createElement('div');
      div.className = 'notification';
      div.style.borderColor = error ? 'var(--danger)' : 'var(--bell)';
      div.innerHTML = `<span>${error ? '‚ö†Ô∏è' : 'üîî'}</span> ${msg}`;
      document.body.appendChild(div);
      setTimeout(() => div.remove(), 6000);
    }

    // Profile panel functions
    function showProfile() {
      document.getElementById('profileSlidePanel').classList.remove('hidden');
    }

    function closeProfileSlide() {
      document.getElementById('profileSlidePanel').classList.add('hidden');
    }

    function openBackProfile() {
      document.getElementById('backProfilePanel').classList.remove('hidden');
      closeProfileSlide();
    }

    function closeBackProfile() {
      document.getElementById('backProfilePanel').classList.add('hidden');
    }

    function logoutUser() {
      showNotification("Logged out (simulator)");
      document.getElementById('mainApp').classList.add('hidden');
      document.getElementById('loginPage').classList.remove('hidden');
      closeBackProfile();
      closeProfileSlide();
    }

    function openDepositModal() {
      showNotification("Deposit feature opening... Connect wallet & select chain (coming soon)", false);
    }

    function openSwapModal() {
      showNotification("Opening Swap interface...", false);
      closeProfileSlide();
      showSection('swap');
    }

    function openSendModal() {
      showNotification("Send feature: Enter recipient address & amount (simulation mode)", false);
    }

    // === FIXED PROFILE TABS ===
    function initProfileTabs() {
      document.querySelectorAll('.profile-slide-tab').forEach(button => {
        button.addEventListener('click', () => {
          const tabName = button.dataset.tab;

          // Update tab buttons
          document.querySelectorAll('.profile-slide-tab').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.tab === tabName);
          });

          // Update content panels
          document.getElementById('assetsContent').classList.toggle('active', tabName === 'assets');
          document.getElementById('activityContent').classList.toggle('active', tabName === 'activity');
        });
      });
    }

    // === MAIN SECTION SWITCHER ===
    let stakedMoga = 0;
    let mogalandPoints = 0;
    let currentQuestionIndex = 0;
    let historyLog = [];

    const questions = [
      { question: "What is the primary function of the Plume network?", options: ["A) Decentralized Storage", "B) NFT Staking", "C) Market Prediction", "D) Data Processing"], correct: 1 },
      { question: "What token is used for staking in Mogaland?", options: ["A) PLUME", "B) MOGA", "C) ETH", "D) USDT"], correct: 1 },
      { question: "RWA stands for...", options: ["A) Real World Assets", "B) Rapid Wallet Access", "C) Remote Work Agreement", "D) Real World Avatar"], correct: 0 }
    ];

    let tokenTreasury = 100000;
    let plumeBalance = "0.00";
    let mogaBalance = 0;
    let currentSlippageTolerance = 0.5;

    let stakedNFTs = 0;
    let nftRewards = 0;
    let selectedNFTs = new Set();

    function updateTreasuryDisplay() {
      const el = document.getElementById('treasuryDisplay');
      if (el) el.textContent = `${tokenTreasury.toLocaleString()} MOGA`;
    }

    function showSection(id, event) {
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      if (event && event.target) event.target.classList.add('active');

      const content = document.getElementById('content');
      content.innerHTML = '';

      if (id === 'learning') {
        content.innerHTML = `
          <div class="flex-container">
            <div class="progress-box">
              <h4 id="progressTitle">PROGRESS 1-100</h4>
              <div class="reach">REACH 100</div>
              <div class="nft-container">
                <div class="nft-placeholder">
                  <div class="nft-gradient"></div>
                  <div class="nft-label">NFT dari OpenSea</div>
                </div>
              </div>
              <div class="progress-section">
                <div class="progress-bar-long">
                  <div class="progress-fill-long" id="progressFill" style="width: 0%;"></div>
                </div>
                <span class="progress-label" id="progressLabel">0% menuju 100</span>
              </div>
            </div>

            <div class="question-box">
              <div class="question-card">
                <div class="question-number" id="qNumber">${currentQuestionIndex + 1})</div>
                <p class="question-title" id="qTitle"></p>
                <div style="margin:20px 0;" id="optionsContainer"></div>
                <div class="btn-group">
                  <button class="btn-primary" onclick="submitAnswer()">Submit</button>
                  <button class="btn-primary" style="background:linear-gradient(90deg,#6b7280,#9ca3af);" onclick="saveProgress()">Save Progress</button>
                </div>
              </div>
            </div>

            <div style="flex:1; min-width:320px;">
              <div class="card">
                <h3>Stake Mogaland</h3>
                <p style="margin-bottom:12px;">Nominal stake amount</p>
                <input type="number" id="stakeAmount" placeholder="Enter amount" style="width:100%; padding:12px; background:#0f172a; border:1px solid var(--border); border-radius:8px; color:white; margin-bottom:16px;"/>
                <button class="btn-primary" onclick="confirmStake()">Confirm</button>
                <p class="stake-info" id="stakedDisplay">Staked: 0 MOGA</p>

                <p style="margin:16px 0 8px;">Unstake amount</p>
                <input type="number" id="unstakeAmount" placeholder="Enter amount or leave blank for all" style="width:100%; padding:12px; background:#0f172a; border:1px solid var(--border); border-radius:8px; color:white; margin-bottom:16px;"/>
                <button class="btn-primary" style="background:linear-gradient(90deg,var(--danger),#f87171);" onclick="unstake()">Unstake</button>
              </div>

              <div class="card" style="margin-top:20px;">
                <h3>Mogaland Point</h3>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                  <span>Progress</span>
                  <span style="font-weight:bold; color:#10b981;" id="pointDisplay">0 POINT</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="pointProgress" style="width:0%;"></div>
                </div>
                <button class="btn-primary btn-success" style="margin-top:16px;" onclick="convertPoints()">Convert</button>
                <div class="history" id="historyLog">
                  <strong>History:</strong><br>
                  <div id="historyItems"></div>
                </div>
              </div>
            </div>
          </div>
        `;

        currentQuestionIndex = 0;
        mogalandPoints = 0;
        stakedMoga = 0;
        historyLog = [];
        document.getElementById('historyItems').innerHTML = '';
        loadQuestion();
        updatePointDisplay();
        updateProgressDisplay();
        updateStakedDisplay();
      } 
      else if (id === 'market') {
        content.innerHTML = `
          <div style="max-width:1600px; margin:0 auto; padding:20px; color:white;">
            <h2 style="text-align:center; margin-bottom:10px; color:#60a5fa;">Mogaland-Plume Market Prediction</h2>
            <p style="text-align:center; opacity:0.8; margin-bottom:20px;">Simulator ‚Äî Predict mock movements or match results, bet with MOGA! (Demo only)</p>

            <div style="display:flex; justify-content:center; gap:8px; margin-bottom:25px; flex-wrap:wrap;">
              <button class="nav-btn active" data-tab="crypto">Crypto</button>
              <button class="nav-btn" data-tab="stocks">Stocks</button>
              <button class="nav-btn" data-tab="commodities">Commodities</button>
              <button class="nav-btn" data-tab="forex">Forex</button>
              <button class="nav-btn" data-tab="sports">Sports</button>
            </div>

            <div class="flex-container" style="gap:25px; align-items:stretch;">
              <div class="card" style="flex:1; max-width:380px; overflow-y:auto; max-height:680px; padding:15px;">
                <h3 style="color:#60a5fa; text-align:center;" id="assetListTitle">Assets</h3>
                <div id="assetList" style="display:flex; flex-direction:column; gap:8px;"></div>
              </div>

              <div class="card" style="flex:2; min-height:580px; padding:20px;">
                <h3 id="viewTitle" style="color:#60a5fa; text-align:center; margin-bottom:15px;">Select to Predict</h3>
                <canvas id="priceChart" height="420" style="display:none;"></canvas>
                <div id="clubHistoryView" style="display:none; color:#e2e8f0; font-size:1.05em; line-height:1.6; padding:15px; background:rgba(13,110,253,0.08); border-radius:12px;"></div>
                <div id="chartFooter" style="text-align:center; margin-top:15px; font-size:0.95em; opacity:0.8; display:none;">
                  Simulated real-time chart ‚Ä¢ Updates every ~8s
                </div>
              </div>

              <div class="card" style="flex:1; max-width:360px; padding:20px;">
                <h3 style="color:#60a5fa;">Place Bet</h3>
                <p>Selection: <strong id="selectedAsset">None</strong></p>
                <p style="font-size:0.95em; opacity:0.8;">Treasury Pool: <strong id="treasuryDisplay">100,000 MOGA</strong></p>
                
                <label style="display:block; margin:12px 0 6px;">Odds Multiplier</label>
                <select id="betOdds" style="width:100%; padding:10px; background:#0f172a; border:1px solid var(--border); border-radius:8px; color:white;">
                  <option value="1.8">Low Risk (1.8x)</option>
                  <option value="2.2" selected>Medium (2.2x)</option>
                  <option value="3.0">High Risk (3.0x)</option>
                </select>

                <div style="margin:20px 0; display:flex; gap:10px;">
                  <button class="btn-primary" style="flex:1; background:#10b981;" onclick="placeBet('win')">BET WIN</button>
                  <button class="btn-primary" style="flex:1; background:#ef4444;" onclick="placeBet('lose')">BET LOSE</button>
                </div>

                <input type="number" id="betAmount" placeholder="Amount (MOGA)" min="10" style="width:100%; padding:12px; margin-bottom:12px; background:#0f172a; border:1px solid var(--border); border-radius:8px; color:white;"/>
                <button class="btn-primary" style="width:100%;" onclick="confirmBet()">Confirm Bet</button>

                <p id="betStatus" style="margin-top:15px; font-weight:bold; min-height:40px;"></p>
                <p id="timerDisplay" style="color:#ffcc00; font-weight:bold; font-size:1.1em;"></p>

                <div style="margin-top:25px;">
                  <h4 style="color:#60a5fa; margin-bottom:8px;">Bet History (MOGA)</h4>
                  <div id="betHistory" style="font-size:0.9em; max-height:180px; overflow-y:auto; color:#94a3b8;"></div>
                </div>
              </div>
            </div>
          </div>
        `;

        const assetsData = {
          crypto: [
            {symbol: "CRYPTC", basePrice: 2299, volatility: 0.025},
            {symbol: "RH-TWIKOh", basePrice: 2044, volatility: 0.018},
            {symbol: "CRYPTSXCOND", basePrice: 2278, volatility: 0.032},
            {symbol: "FBO-PO7EYME", basePrice: 2748, volatility: 0.022},
            {symbol: "MIB-IIFE", basePrice: 2271, volatility: 0.015},
            {symbol: "ERC-TOFTH", basePrice: 2341, volatility: 0.028},
            {symbol: "PEATPH", basePrice: 2239, volatility: 0.035},
            {symbol: "BRC-BENT", basePrice: 4923, volatility: 0.040},
            {symbol: "CRYPTXCONG", basePrice: 3459, volatility: 0.020},
            {symbol: "MASAMM", basePrice: 8499, volatility: 0.012}
          ],
          stocks: [
            {symbol: "AAPL-MOCK", basePrice: 220, volatility: 0.008},
            {symbol: "TSLA-X", basePrice: 350, volatility: 0.045},
            {symbol: "NVDA-IO", basePrice: 140, volatility: 0.030}
          ],
          commodities: [
            {symbol: "GOLD-RWA", basePrice: 2650, volatility: 0.010},
            {symbol: "OIL-BARREL", basePrice: 78, volatility: 0.025}
          ],
          forex: [
            {symbol: "EURUSD", basePrice: 1.085, volatility: 0.005},
            {symbol: "USDJPY", basePrice: 152.3, volatility: 0.007}
          ],
          sports: [
            {symbol: "Real Madrid", type: "football", strength: 0.85, recentForm: [
              "Feb 5, 2026: W 3-1 vs Barcelona (La Liga)",
              "Jan 29, 2026: W 2-0 vs Atletico Madrid (Copa)",
              "Jan 22, 2026: L 1-2 vs Bayern Munich (UCL)",
              "Jan 15, 2026: W 4-0 vs PSG (Friendly)",
              "Jan 8, 2026: D 1-1 vs Man City (Club World Cup)",
              "Jan 1, 2026: W 3-2 vs Liverpool (Supercup)"
            ]},
            // ... other sports teams (shortened for brevity - add your full list if needed) ...
          ]
        };

        let currentTab = 'crypto';
        let selectedAsset = null;
        let chart = null;
        let priceHistory = [];
        let currentBet = null;

        function renderAssets() {
          const container = document.getElementById('assetList');
          const titleEl = document.getElementById('assetListTitle');
          if (!container || !titleEl) return;

          container.innerHTML = '';
          titleEl.textContent = currentTab === 'sports' ? 'Football & Basketball Clubs' : 'Assets';

          const tabAssets = assetsData[currentTab] || [];
          tabAssets.forEach(asset => {
            const div = document.createElement('div');
            div.style.padding = '12px 10px';
            div.style.background = 'rgba(13,110,253,0.1)';
            div.style.borderRadius = '8px';
            div.style.cursor = 'pointer';
            div.innerHTML = `<strong>${asset.symbol}${asset.type ? ` (${asset.type})` : ''}</strong>`;
            div.onclick = currentTab === 'sports' ? () => showClubHistory(asset) : () => selectAsset(asset);
            container.appendChild(div);
          });
        }

        function showClubHistory(asset) {
          selectedAsset = asset;
          document.getElementById('selectedAsset').textContent = asset.symbol;
          document.getElementById('viewTitle').textContent = `${asset.symbol} Last Matches History`;

          document.getElementById('priceChart').style.display = 'none';
          document.getElementById('chartFooter').style.display = 'none';

          const view = document.getElementById('clubHistoryView');
          view.style.display = 'block';
          view.innerHTML = `
            <strong>Recent Results:</strong><br><br>
            ${asset.recentForm.map(r => `<div>${r}</div>`).join('')}
            <br><em>Bet WIN if you think they win next, LOSE if lose!</em>
          `;
        }

        function selectAsset(asset) {
          if (!asset) return;
          selectedAsset = asset;
          document.getElementById('selectedAsset').textContent = asset.symbol;
          document.getElementById('viewTitle').textContent = `${asset.symbol} Grafik`;

          document.getElementById('priceChart').style.display = 'block';
          document.getElementById('chartFooter').style.display = 'block';
          document.getElementById('clubHistoryView').style.display = 'none';

          initChart(asset);
        }

        function generateOHLC(basePrice, count = 40) {
          const data = [];
          let current = basePrice || 1000;
          const now = Date.now();
          for (let i = 0; i < count; i++) {
            const open = current;
            const change = (Math.random() - 0.5) * 0.02 * open * 2;
            const close = open + change;
            data.push({
              x: now - (count - i - 1) * 600000,
              o: open,
              h: Math.max(open, close) + Math.random() * 100,
              l: Math.min(open, close) - Math.random() * 100,
              c: close
            });
            current = close;
          }
          return data;
        }

        function initChart(asset) {
          const canvas = document.getElementById('priceChart');
          if (!canvas) return;

          const ctx = canvas.getContext('2d');
          if (!ctx) return;

          if (chart) chart.destroy();

          priceHistory = generateOHLC(asset.basePrice);

          chart = new Chart(ctx, {
            type: 'candlestick',
            data: {
              datasets: [{
                label: asset.symbol,
                data: priceHistory
              }, {
                label: 'Volume',
                type: 'bar',
                data: priceHistory.map(d => ({x: d.x, y: d.v || Math.floor(Math.random()*10000)})),
                yAxisID: 'volume',
                backgroundColor: 'rgba(59,130,246,0.4)'
              }]
            },
            options: {
              scales: {
                x: { type: 'time', time: { unit: 'minute' }, title: { display: true, text: 'Time' } },
                y: { title: { display: true, text: 'Price ($)' } },
                volume: { position: 'right', title: { display: true, text: 'Vol' }, grid: { drawOnChartArea: false } }
              },
              plugins: { legend: { display: false } }
            }
          });
        }

        setInterval(() => {
          if (selectedAsset && chart && priceHistory.length > 0 && currentTab !== 'sports') {
            const last = priceHistory[priceHistory.length - 1];
            const change = (Math.random() - 0.5) * 0.02 * last.c * 2;
            const open = last.c;
            const close = open + change;
            priceHistory.push({
              x: Date.now(),
              o: open,
              h: Math.max(open, close) + Math.random() * 100,
              l: Math.min(open, close) - Math.random() * 100,
              c: close
            });
            if (priceHistory.length > 80) priceHistory.shift();
            chart.update();
          }
        }, 8000);

        function placeBet(direction) {
          if (!selectedAsset) return showNotification("Select first!", true);
          currentBet = { asset: selectedAsset.symbol, direction, odds: parseFloat(document.getElementById('betOdds').value) || 2.2 };
          document.getElementById('betStatus').textContent = `Bet: ${direction.toUpperCase()} on ${selectedAsset.symbol}`;
        }

        function confirmBet() {
          const amt = parseFloat(document.getElementById('betAmount').value);
          if (!currentBet || isNaN(amt) || amt < 10) return showNotification("Min 10 MOGA", true);
          if (amt > mogalandPoints) return showNotification("Not enough!", true);

          mogalandPoints -= amt;

          let timeLeft = 10;
          document.getElementById('timerDisplay').textContent = `Result in ${timeLeft}s`;
          const interval = setInterval(() => {
            timeLeft--;
            document.getElementById('timerDisplay').textContent = timeLeft > 0 ? `Result in ${timeLeft}s` : '';
            if (timeLeft <= 0) {
              clearInterval(interval);
              const win = Math.random() > 0.5;
              if (win) {
                const profit = Math.round(amt * (currentBet.odds - 1));
                mogalandPoints += amt + profit;
                showNotification(`WIN! +${profit} MOGA`, false);
              } else {
                showNotification(`LOSE -${amt} MOGA`, true);
              }
              document.getElementById('timerDisplay').textContent = '';
            }
          }, 1000);
        }

        renderAssets();
        if (assetsData.crypto.length > 0) selectAsset(assetsData.crypto[0]);
        updateTreasuryDisplay();

        document.querySelectorAll('[data-tab]').forEach(btn => {
          btn.onclick = () => {
            document.querySelectorAll('[data-tab]').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentTab = btn.dataset.tab;
            renderAssets();
            selectedAsset = null;
            document.getElementById('selectedAsset').textContent = 'None';
            document.getElementById('viewTitle').textContent = 'Select to Predict';
            document.getElementById('priceChart').style.display = 'none';
            document.getElementById('clubHistoryView').style.display = 'none';
            document.getElementById('chartFooter').style.display = currentTab !== 'sports' ? 'block' : 'none';
            if (chart) chart.destroy();
            chart = null;
          };
        });
      } 
      else if (id === 'swap') {
        content.innerHTML = `
          <div style="max-width: 480px; margin: 40px auto; padding: 0 12px;">
            <h2 style="text-align: center; color: #60a5fa; font-size: 1.8em; margin-bottom: 24px; font-weight: 600;">
              Swap on Plume
            </h2>

            ${!userAddress ? `
              <div style="background: rgba(220,53,69,0.12); border: 1px solid #dc3545; color: #ffcccc; padding: 12px; border-radius: 10px; margin-bottom: 20px; text-align: center; font-size: 0.95em;">
                Connect wallet untuk lihat saldo PLUME real
              </div>
            ` : ''}

            <div style="padding: 20px; border-radius: 16px; background: var(--card-bg); border: 1px solid var(--border); box-shadow: 0 4px 16px rgba(0,0,0,0.3); margin-bottom: 20px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <select id="fromTokenSelect" onchange="updateSwapEstimate()" style="padding: 8px; background: var(--darker); border: 1px solid var(--border); border-radius: 8px; color: white; font-size: 1em;">
                  <option value="PLUME">PLUME (Native)</option>
                  <option value="MOGA">MOGA (Mogaland)</option>
                  <option value="USDT">USDT</option>
                  <option value="USDC">USDC</option>
                </select>

                <button onclick="toggleSwapDirection()" style="background: #0d6efd; width: 48px; height: 48px; border-radius: 50%; border: none; font-size: 1.5em; color: white; cursor: pointer; box-shadow: 0 4px 12px rgba(13,110,253,0.4); transition: transform 0.2s;">
                  ‚Üî
                </button>

                <select id="toTokenSelect" onchange="updateSwapEstimate()" style="padding: 8px; background: var(--darker); border: 1px solid var(--border); border-radius: 8px; color: white; font-size: 1em;">
                  <option value="MOGA">MOGA (Mogaland)</option>
                  <option value="PLUME">PLUME (Native)</option>
                  <option value="USDT">USDT</option>
                  <option value="USDC">USDC</option>
                </select>
              </div>

              <input id="fromInput" type="number" placeholder="0.0" min="0" step="any" style="width: 100%; font-size: 2.4em; font-weight: 500; background: transparent; border: none; color: white; text-align: right; outline: none;" oninput="updateSwapEstimate()" />

              <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 0.9em; color: #94a3b8;">
                <span>Balance: <strong id="plumeBalance" style="color: white;">Loading...</strong></span>
                <span>~$<span id="fromUSD">0.00</span></span>
              </div>
            </div>

            <div id="swapEstimate" style="margin: 16px 0; padding: 10px; background: rgba(16,185,129,0.08); border-radius: 10px; font-size: 1em; color: #10b981; text-align: center;">
              Estimasi: 0.00 (1 PLUME ‚âà 100 MOGA)
            </div>

            <div style="margin: 24px 0; padding: 14px; background: rgba(13,110,253,0.08); border-radius: 14px; border: 1px solid var(--border);">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <label style="font-size: 1em; color: #60a5fa;">Slippage</label>
                <span id="currentSlippage" style="font-weight: bold; color: #10b981; font-size: 1em;">0.5%</span>
              </div>
              <div style="display: flex; gap: 6px; flex-wrap: wrap; justify-content: center;">
                <button class="slippage-chip" data-value="0.1" onclick="setSlippage(0.1)">0.1%</button>
                <button class="slippage-chip active" data-value="0.5" onclick="setSlippage(0.5)">0.5%</button>
                <button class="slippage-chip" data-value="1.0" onclick="setSlippage(1.0)">1.0%</button>
                <input id="customSlippage" type="number" placeholder="Custom" min="0" max="10" step="0.1" style="width: 80px; padding: 8px; background: var(--darker); border: 1px solid var(--border); border-radius: 10px; color: white; text-align: center; font-size: 0.9em;" onchange="setSlippage(this.value)" />
              </div>
              <p id="slippageWarning" style="margin-top: 10px; font-size: 0.85em; color: #ffcc00; text-align: center; display: none;">
                Slippage tinggi bisa berisiko
              </p>
            </div>

            <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1.25em; border-radius: 14px;" onclick="confirmSwap()">
              Swap Now
            </button>

            <p style="text-align: center; margin-top: 20px; color: #94a3b8; font-size: 0.9em;">
              PLUME real ‚Ä¢ MOGA/USDT/USDC simulasi ‚Ä¢ Demo
            </p>
          </div>
        `;

        setTimeout(() => {
          if (userAddress) updateTokenBalances();
          updateSwapEstimate();
          setSlippage(0.5);
        }, 100);
      } 
      else if (id === 'bridge') {
        content.innerHTML = `
          <div style="max-width: 520px; margin: 60px auto 140px; padding: 0 16px;">
            <h2 style="text-align: center; color: #60a5fa; font-size: 2.4em; margin-bottom: 16px; font-weight: 600;">
              Bridge Assets
            </h2>
            <p style="text-align: center; color: #94a3b8; margin-bottom: 32px; font-size: 1.1em;">
              Transfer between Ethereum, BNB Chain, Solana, Plume (Simulator)
            </p>

            <div style="background: #13151f; border: 1px solid #1e2130; border-radius: 24px; padding: 32px 24px; box-shadow: 0 12px 48px rgba(0,0,0,0.7);">
              <div style="margin-bottom: 32px;">
                <label style="display: block; color: #94a3b8; font-size: 1em; margin-bottom: 10px; font-weight: 500;">From</label>
                <div style="background: #1e2130; border-radius: 16px; padding: 20px;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
                    <select id="fromChain" style="background: #2a2f45; color: white; font-size: 1.2em; border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; min-width: 180px; cursor: pointer;">
                      <option value="ethereum">Ethereum (ETH)</option>
                      <option value="bnb">BNB Chain</option>
                      <option value="solana">Solana (SOL)</option>
                      <option value="plume" selected>Plume</option>
                    </select>
                    <span style="color: #94a3b8; font-size: 0.95em;">Balance: 0.00</span>
                  </div>
                  <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
                    <input type="number" id="bridgeAmount" placeholder="0.00" style="background: transparent; border: none; color: white; font-size: 3em; font-weight: 600; flex: 1; min-width: 120px; outline: none;" />
                    <select style="background: #2a2f45; color: white; border: none; padding: 12px 16px; border-radius: 14px; font-size: 1.15em; cursor: pointer; min-width: 140px;">
                      <option>MOGA</option>
                      <option>USDT</option>
                      <option>USDC</option>
                      <option>PLUME</option>
                    </select>
                  </div>
                  <div style="text-align: right; color: #94a3b8; font-size: 0.95em; margin-top: 8px;">~$0.00</div>
                </div>
              </div>

              <div style="display: flex; justify-content: center; margin: 28px 0;">
                <button id="swapChainsBtn" style="background: #1e2130; border: 4px solid #13151f; border-radius: 50%; width: 68px; height: 68px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                  <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#ec4899" stroke-width="2.8">
                    <path d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                  </svg>
                </button>
              </div>

              <div style="margin-bottom: 32px;">
                <label style="display: block; color: #94a3b8; font-size: 1em; margin-bottom: 10px; font-weight: 500;">To</label>
                <div style="background: #1e2130; border-radius: 16px; padding: 20px;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 12px;">
                    <select id="toChain" style="background: #2a2f45; color: white; font-size: 1.2em; border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; min-width: 180px; cursor: pointer;">
                      <option value="plume" selected>Plume</option>
                      <option value="ethereum">Ethereum (ETH)</option>
                      <option value="bnb">BNB Chain</option>
                      <option value="solana">Solana (SOL)</option>
                    </select>
                    <span style="color: #94a3b8; font-size: 0.95em;">Balance: 0.00</span>
                  </div>
                  <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
                    <input type="number" placeholder="0.00" disabled style="background: transparent; border: none; color: #6b7280; font-size: 3em; font-weight: 600; flex: 1; min-width: 120px; outline: none;" />
                    <select style="background: #2a2f45; color: white; border: none; padding: 12px 16px; border-radius: 14px; font-size: 1.15em; cursor: pointer; min-width: 140px;">
                      <option>MOGA</option>
                      <option>USDT</option>
                      <option>USDC</option>
                      <option>PLUME</option>
                    </select>
                  </div>
                  <div style="text-align: right; color: #94a3b8; font-size: 0.95em; margin-top: 8px;">~$0.00</div>
                </div>
              </div>

              <div style="background: rgba(236,72,153,0.08); border-radius: 14px; padding: 16px; margin-bottom: 28px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: #94a3b8;">
                  <span>Estimated Fee</span>
                  <span>~$3.50 ‚Äì $8.00</span>
                </div>
                <div style="display: flex; justify-content: space-between; color: #94a3b8;">
                  <span>Estimated Time</span>
                  <span>~1-8 minutes</span>
                </div>
              </div>

              <button class="btn-primary" style="width: 100%; padding: 20px; font-size: 1.35em; border-radius: 16px;">
                Bridge Now
              </button>

              <p style="text-align: center; margin-top: 28px; color: #94a3b8; font-size: 0.95em;">
                Simulator only ‚Äì real Plume supports deBridge, CCTP, etc.
              </p>
            </div>
          </div>
        `;

        document.getElementById('swapChainsBtn')?.addEventListener('click', () => {
          const from = document.getElementById('fromChain');
          const to = document.getElementById('toChain');
          if (from && to) {
            const temp = from.value;
            from.value = to.value;
            to.value = temp;
            showNotification("Chains swapped!", false);
          }
        });
      } 
      else if (id === 'nft') {
        content.innerHTML = `
          <h2 style="text-align:center; margin:40px 0; color:#60a5fa;">NFT Staking</h2>
          <p style="text-align:center; font-size:1.2em; color:#94a3b8; margin-bottom:32px;">
            Stake your Mogaland NFTs and earn PLUME rewards (simulator)
          </p>

          <div class="stats-grid">
            <div class="stats-card">
              <h4>Total Staked NFTs</h4>
              <div class="stats-value" style="color:#60a5fa;">${stakedNFTs}</div>
            </div>
            <div class="stats-card">
              <h4>Your Rewards</h4>
              <div class="stats-value" style="color:#10b981;">${nftRewards.toFixed(2)} PLUME</div>
            </div>
            <div class="stats-card">
              <h4>Current APY</h4>
              <div class="stats-value" style="color:#c084fc;">18.5%</div>
            </div>
          </div>

          <h3 style="color:#60a5fa; margin:32px 0 16px;">Your Owned NFTs</h3>
          <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(240px, 1fr)); gap:20px; margin-bottom:60px;">
            ${generateNFTCards(8, false)}
          </div>

          <h3 style="color:#60a5fa; margin:32px 0 16px;">Currently Staked</h3>
          <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(240px, 1fr)); gap:20px;">
            ${generateNFTCards(5, true)}
          </div>

          <div style="position:fixed; bottom:90px; left:50%; transform:translateX(-50%); background:rgba(15,23,42,0.9); backdrop-filter:blur(10px); border:1px solid var(--border); border-radius:60px; padding:12px 32px; display:flex; gap:16px; z-index:90; box-shadow:0 8px 30px rgba(0,0,0,0.6);">
            <button class="btn-primary" style="padding:14px 28px;" onclick="stakeSelectedNFTs()">Stake Selected</button>
            <button class="btn-primary" style="background:linear-gradient(90deg,var(--danger),#f87171); padding:14px 28px;" onclick="unstakeSelectedNFTs()">Unstake</button>
            <button class="btn-primary" style="background:linear-gradient(90deg,#10b981,#34d399); padding:14px 28px;" onclick="claimNFTRewards()">Claim Rewards</button>
          </div>
        `;
      } else {
        content.innerHTML = `
          <h2 style="text-align:center; margin:40px 0;">${id.charAt(0).toUpperCase() + id.slice(1)}</h2>
          <p style="text-align:center; font-size:1.2em;">Coming soon ‚Äì ${id} simulator in progress üöß</p>
        `;
      }
    }

    // NFT Staking functions
    function generateNFTCards(count, isStaked = false) {
      let html = '';
      for (let i = 1; i <= count; i++) {
        const id = isStaked ? i + 100 : i;
        const rarity = ['Common', 'Rare', 'Epic', 'Legendary'][Math.floor(Math.random() * 4)];
        html += `
          <div class="nft-card" style="border: 2px solid ${isStaked ? '#10b981' : 'var(--border)'}; ${selectedNFTs.has(id) ? 'border-color:#60a5fa; transform:scale(1.04);' : ''}">
            ${isStaked ? '<div class="nft-staked-badge">STAKED</div>' : ''}
            <div class="nft-image-placeholder">MOGA #${String(id).padStart(4, '0')}</div>
            <div style="padding:16px;">
              <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                <div style="font-weight:bold;">MOGA #${String(id).padStart(4,'0')}</div>
                <div style="color:#c084fc;">${rarity}</div>
              </div>
              <button class="btn-primary" style="${isStaked ? 'background:linear-gradient(90deg,var(--danger),#f87171);' : ''}" onclick="toggleSelectNFT(${id})">
                ${selectedNFTs.has(id) ? (isStaked ? 'Deselect' : 'Selected') : (isStaked ? 'Select to Unstake' : 'Select to Stake')}
              </button>
            </div>
          </div>
        `;
      }
      return html;
    }

    function toggleSelectNFT(id) {
      if (selectedNFTs.has(id)) selectedNFTs.delete(id);
      else selectedNFTs.add(id);
      showSection('nft');
      showNotification(selectedNFTs.has(id) ? `NFT #${id} dipilih` : `NFT #${id} dibatalkan`, false);
    }

    function stakeSelectedNFTs() {
      if (selectedNFTs.size === 0) return showNotification("Tidak ada NFT yang dipilih!", true);
      stakedNFTs += selectedNFTs.size;
      nftRewards += selectedNFTs.size * 2.5;
      selectedNFTs.clear();
      showSection('nft');
      showNotification(`Berhasil stake ${selectedNFTs.size} NFT!`);
    }

    function unstakeSelectedNFTs() {
      if (selectedNFTs.size === 0) return showNotification("Tidak ada NFT staked yang dipilih!", true);
      stakedNFTs = Math.max(0, stakedNFTs - selectedNFTs.size);
      selectedNFTs.clear();
      showSection('nft');
      showNotification(`Berhasil unstake ${selectedNFTs.size} NFT`);
    }

    function claimNFTRewards() {
      if (nftRewards <= 0) return showNotification("Belum ada reward", true);
      const claimed = nftRewards;
      nftRewards = 0;
      showSection('nft');
      showNotification(`Claimed ${claimed.toFixed(2)} PLUME!`);
    }

    // Swap functions
    function updateTokenBalances() {
      if (!provider || !userAddress) {
        plumeBalance = "0.00";
        mogaBalance = 0;
      } else {
        try {
          const plumeWei = provider.getBalance(userAddress);
          plumeBalance = ethers.utils.formatEther(plumeWei);
          mogaBalance = mogalandPoints;
        } catch (err) {
          showNotification("Gagal memuat saldo", true);
          plumeBalance = "Error";
          mogaBalance = 0;
        }
      }

      document.querySelectorAll('#plumeBalance').forEach(el => el.textContent = parseFloat(plumeBalance).toFixed(4));
    }

    function updateSwapEstimate() {
      const fromAmt = parseFloat(document.getElementById('fromInput')?.value) || 0;
      const fromToken = document.getElementById('fromTokenSelect')?.value || 'PLUME';
      const toToken = document.getElementById('toTokenSelect')?.value || 'MOGA';

      let rate = 1;
      if (fromToken === 'PLUME' && toToken === 'MOGA') rate = 100;
      if (fromToken === 'MOGA' && toToken === 'PLUME') rate = 0.01;
      if (fromToken === 'PLUME' && (toToken === 'USDT' || toToken === 'USDC')) rate = 0.01;
      if ((fromToken === 'USDT' || fromToken === 'USDC') && toToken === 'PLUME') rate = 100;

      const estOut = (fromAmt * rate).toFixed(4);
      const impact = fromAmt > 0 ? `~0.12% impact (${currentSlippageTolerance.toFixed(1)}% tolerance)` : "";

      const estEl = document.getElementById('swapEstimate');
      if (estEl) {
        estEl.innerHTML = `Estimasi: <strong>${estOut} ${toToken}</strong> (1 ${fromToken} ‚âà ${rate} ${toToken})<br><small style="color:#94a3b8;">${impact}</small>`;
      }
    }

    function setSlippage(value) {
      const val = parseFloat(value);
      if (isNaN(val) || val < 0 || val > 10) {
        showNotification("Slippage harus 0‚Äì10%", true);
        return;
      }

      currentSlippageTolerance = val;
      document.getElementById('currentSlippage').textContent = val.toFixed(1) + '%';

      document.querySelectorAll('.slippage-chip').forEach(btn => {
        btn.classList.remove('active');
        if (parseFloat(btn.dataset.value) === val) btn.classList.add('active');
      });

      document.getElementById('customSlippage').value = val;

      document.getElementById('slippageWarning').style.display = (val > 3) ? 'block' : 'none';

      updateSwapEstimate();
    }

    function confirmSwap() {
      const amt = parseFloat(document.getElementById('fromInput')?.value) || 0;
      if (amt <= 0) return showNotification("Masukkan jumlah > 0", true);
      if (!userAddress) return showNotification("Hubungkan wallet terlebih dahulu", true);

      const fromToken = document.getElementById('fromTokenSelect')?.value || 'PLUME';
      const toToken = document.getElementById('toTokenSelect')?.value || 'MOGA';

      showNotification(
        `Simulasi swap: ${amt.toFixed(6)} ${fromToken} ‚Üí ${toToken}<br>Slippage: ${currentSlippageTolerance.toFixed(1)}%`,
        false
      );
    }

    function toggleSwapDirection() {
      const fromSelect = document.getElementById('fromTokenSelect');
      const toSelect = document.getElementById('toTokenSelect');
      if (fromSelect && toSelect) {
        const temp = fromSelect.value;
        fromSelect.value = toSelect.value;
        toSelect.value = temp;
        updateSwapEstimate();
        showNotification(`Direction swap diubah menjadi ${fromSelect.value} ‚Üí ${toSelect.value}`, false);
      }
    }

    // Quiz & Stake functions
    function loadQuestion() {
      if (currentQuestionIndex >= questions.length) {
        document.getElementById('qTitle').textContent = "Quiz Selesai! Semua soal sudah dijawab.";
        document.getElementById('optionsContainer').innerHTML = '';
        document.querySelector('.btn-group').innerHTML = '<button class="btn-primary" onclick="restartQuiz()">Mulai Ulang</button>';
        return;
      }

      const q = questions[currentQuestionIndex];
      document.getElementById('qNumber').textContent = `${currentQuestionIndex + 1})`;
      document.getElementById('qTitle').textContent = q.question;

      const container = document.getElementById('optionsContainer');
      container.innerHTML = '';
      q.options.forEach((opt, index) => {
        container.innerHTML += `
          <label style="display:block; margin:12px 0; font-size:1.1em; cursor:pointer;">
            <input type="radio" name="q" value="${index}"> ${opt}
          </label>
        `;
      });
    }

    function submitAnswer() {
      const selected = document.querySelector('input[name="q"]:checked');
      
      if (!selected) {
        showNotification("Pilih satu jawaban terlebih dahulu!", true);
        return;
      }

      const chosenIndex = parseInt(selected.value);
      const correctIndex = questions[currentQuestionIndex].correct;

      if (chosenIndex === correctIndex) {
        mogalandPoints += 20;
        showNotification("Benar! +20 Mogaland Point", false);
        currentQuestionIndex++;
        loadQuestion();
        updateProgressDisplay();
      } else {
        mogalandPoints = Math.max(0, mogalandPoints - 10);
        showNotification("Salah! -10 Mogaland Point", true);
      }

      updatePointDisplay();
    }

    function restartQuiz() {
      currentQuestionIndex = 0;
      loadQuestion();
      updateProgressDisplay();
    }

    function updatePointDisplay() {
      const el = document.getElementById('pointDisplay');
      if (el) {
        el.textContent = `${mogalandPoints} POINT`;
        const progressPercent = Math.min((mogalandPoints / 1000) * 100, 100);
        const progEl = document.getElementById('pointProgress');
        if (progEl) progEl.style.width = `${progressPercent}%`;
      }
    }

    function updateProgressDisplay() {
      const title = document.getElementById('progressTitle');
      if (title) {
        title.textContent = `PROGRESS ${currentQuestionIndex + 1}-100`;
      }

      const fill = document.getElementById('progressFill');
      const label = document.getElementById('progressLabel');
      if (fill && label) {
        const percent = Math.min((mogalandPoints / 1000) * 100, 100);
        fill.style.width = percent + '%';
        label.textContent = percent.toFixed(0) + '% menuju 100';
      }
    }

    function confirmStake() {
      const amount = parseFloat(document.getElementById('stakeAmount').value);
      if (isNaN(amount) || amount <= 0) return showNotification("Masukkan nominal yang valid!", true);
      stakedMoga += amount;
      updateStakedDisplay();
      document.getElementById('stakeAmount').value = '';
      showNotification(`Berhasil stake ${amount} MOGA!`);
    }

    function unstake() {
      const amount = parseFloat(document.getElementById('unstakeAmount').value);
      if (isNaN(amount) || amount <= 0) return showNotification("Masukkan nominal unstake yang valid!", true);
      if (amount > stakedMoga) return showNotification("Saldo stake tidak cukup!", true);

      stakedMoga -= amount;
      updateStakedDisplay();
      document.getElementById('unstakeAmount').value = '';
      showNotification(`Berhasil unstake ${amount} MOGA!`);
    }

    function updateStakedDisplay() {
      const el = document.getElementById('stakedDisplay');
      if (el) el.textContent = `Staked: ${stakedMoga} MOGA`;
    }

    function saveProgress() {
      showNotification("Progress disimpan (simulasi only)");
    }

    function convertPoints() {
      showNotification("Convert point ke token (simulasi only)");
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      initProfileTabs();
      showSection('swap');
    });
  </script>
</body>
</html>